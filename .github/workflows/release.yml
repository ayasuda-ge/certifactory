name: release-ca-ci
on:
  push:
    branches: [ release ]
  pull_request:
    branches: [ release ]
    types: [opened, synchronize]
  workflow_dispatch:
    inputs:
      name:
        description: 'Describe the Common Name of the certificate request. E.g. "A Test Digital Certificate"'
        required: true
        default: ''
      home:
        description: 'Your Country. E.g. "US"'
        required: true
        default: ''
jobs:
  build:
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.message, '[skip ci]')"
    environment: release
    env:
      AGENT_REV: "1.2-rc.0.reiwa"
      CA_CERT: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUdRakNDQlNxZ0F3SUJBZ0lRTnIvd0xZUXZUcUorTDFhYnp4Y09LakFOQmdrcWhraUc5dzBCQVFzRkFEQ0IKMlRFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RWpBUUJnTlZCQWNUQ1ZOaApiaUJTWVcxdmJqRWFNQmdHQTFVRUNSTVJNall5TXlCRFlXMXBibThnVW1GdGIyNHhEakFNQmdOVkJCRVRCVGswCk5UZ3pNU293S0FZRFZRUUtFeUZGYm5SbGNuQnlhWE5sTFVOdmJtNWxZM1FnUTNsaVpYSXRVMlZqZFhKcGRIa3gKR2pBWUJnTlZCQU1URVVWRElFTkJJRk5sY25acFkyVnpJRWxKTVMwd0t3WURWUVFGRXlRME56YzVNRGhsT0MwNApaVGt3TFRRd1kyTXRPVGM0WWkxa09XSTJNbVl4TWpFMllXVXdIaGNOTWpBeE1qRXhNRGd5TVRNMldoY05Nakl4Ck1qRXhNRGd5TVRNMldqQ0NBU0V4Q3pBSkJnTlZCQVlUQWxWVE1SRXdEd1lEVlFRSUV3aE5hV05vYVdkaGJqRWoKTUNFR0ExVUVCeE1hVm1GdUlFSjFjbVZ1SUVOb1lYSjBaWElnVkc5M2JuTm9hWEF4R3pBWkJnTlZCQWtURWpRdwpJRmRsYzNRZ1JTQk5ZV2x1SUZOMExqRU9NQXdHQTFVRUVSTUZORGd4TVRFeEd6QVpCZ05WQkFvVEVrVnVkR1Z5CmNISnBjMlV0UTI5dWJtVmpkREVxTUNnR0ExVUVDeE1oUlc1MFpYSndjbWx6WlMxRGIyNXVaV04wSUV4cFkyVnUKYzJsdVp5QkVhWFl1TVRVd013WURWUVFERXl4RmJuUmxjbkJ5YVhObExVTnZibTVsWTNRZ1RHbGpaVzV6YVc1bgpJRU5CSUVsSklDaFNaV3hsWVhObEtURXRNQ3NHQTFVRUJSTWtaR1l3TUdFMFkyRXRZamhsTUMwME16WTRMV0U1Ck5tTXRNV05sTUdKbU1UUm1OV1UzTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUEKeDRoblRhRm10STk0dmJkcW9xeW1DWU9aZnZYbVhZRzRvOFFONFFyYnowNHcyWjh1VkRkMnlpYmwyeWx2OGZ6VQp0SkM3UWNpWS9TVmR2UEg2YUZaaERKbEdadUk0dnlyd3NwOFJwc3JLZ2tQRFFMUUFQMGtRdCtWRTlTSThQc3ZJCjF2bDJxYXlWV2oxQ3BncVNGeU5KL1FmY3ZUclhDdFMzSlFCVEl4L3BGT0NFZEhGWEJTZ2dWM1FSek4vZWoranEKSEVmK3drVnN1RVpJSkxsdytJaU5RQkpremc2WTRmOEloWjlScHpTZmZOei9xWlhnVU5YeE5Ua0lFK1E4bEd2eAorV2VTT2QzN0xvaHpPTk1sVGh2QS95TjlFRXRpSlpaMWw4K2dNZTV4MXlJZGJhUU1lZWp6RVRlUm52cThwZFZyCkROckcxMU5zRUlDUFVsMXhsL21IcVFJREFRQUJvNElCdVRDQ0FiVXdEZ1lEVlIwUEFRSC9CQVFEQWdLa01CMEcKQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUMwRwpBMVVkRGdRbUJDUmtaakF3WVRSallTMWlPR1V3TFRRek5qZ3RZVGsyWXkweFkyVXdZbVl4TkdZMVpUY3dMd1lEClZSMGpCQ2d3Sm9Ba05XTXhZekppTW1FdE1XVXlOUzAwTlRjMExXRmlNRGt0Tm1RMFpXUmpZVEU1TVdZMU1JR1EKQmdOVkhSRUVnWWd3Z1lXQ0NXVmpMbWRsTG1OdmJZRVNaV010Y21WelpXRnlZMmhBWjJVdVkyOXRod1IvQUFBQgpoeEFBQUFBQUFBQUFBQUFBQUFBQUFBQUJod1RBcUZVV2h3VEFxRmJmaHhEK2dBQUFBQUFBQU42bU12LytKcEc3Cmh3U3NFUUFCaHdSbFpSRCtoeEQrZ0FBQUFBQUFBQUJDVlAvK2ZhaWVoeEQrZ0FBQUFBQUFBS1F0R1AvK2RSRmIKTUF3R0F6SUtBUVFGUVVSTlNVNHdEUVlEUEFvQkJBWkVRMTlCVjFNd0RnWURSZ29CQkFkVFpXRjBYM2d4TUE4RwpBendVQVFRSVlYQndMbUYxZEdnd0ZRWURQQjRCQkE1bllYUmxkMkY1TEhObGNuWmxjakFyQmdOR0ZBRUVKR1EzClpqVmtNREV6TFRkaU9UVXROR1V4WlMwNU5XSmhMV001TmpFeE1EVm1NelZsTkRBTkJna3Foa2lHOXcwQkFRc0YKQUFPQ0FRRUFBZzR0cnIvbm84VzdRYll4c1lvT0xDY2tzZ09PMTRjb1Rrb2w1STZVeHVTSzlVSlJ0NVJhZjVwWAp5QmxUb2dzaVNpbTAweVJnK2pjeENmVGR4eHVuclVYVEtVV00wbFYzdlhLMkVuYWN6RG55N0FINVNBakttZ3FwCnlQaERieFB5Z2I5QkVNMktzV3BpcTMwN1dmSVVBVkFqM2RBTU8rUGJ4OHBRWW9KcmVUdkUyYnQvL2xzSnZ1OFUKZ24rVGtua2tGeHF1ZmdiNk0rYmVyUXVHeUd5RDJaVWU0UkNaZzVPa1dlVUxQVDRVMmtIbnVrbGNRck9KWGJPegpLaXlRdGF2Qk1TOTRRcVJIYTJFY1FrdWJ6NzFjTTZTemdsb2RaWnhFNlNkZXVaY0ZHTjlObXExdHJNZ0xsZHg5Ck91em5KbWtEODkrTlNvUlRwaGNwLzdVaGFlcVlTdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZkakNDQkY2Z0F3SUJBZ0lRZThnQ0tOU0ZCSFVMb1BoSEhBaGZ0akFOQmdrcWhraUc5dzBCQVFzRkFEQ0IKMlRFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RWpBUUJnTlZCQWNUQ1ZOaApiaUJTWVcxdmJqRWFNQmdHQTFVRUNSTVJNall5TXlCRFlXMXBibThnVW1GdGIyNHhEakFNQmdOVkJCRVRCVGswCk5UZ3pNU293S0FZRFZRUUtFeUZGYm5SbGNuQnlhWE5sTFVOdmJtNWxZM1FnUTNsaVpYSXRVMlZqZFhKcGRIa3gKR2pBWUJnTlZCQU1URVVWRElFTkJJRk5sY25acFkyVnpJRWxKTVMwd0t3WURWUVFGRXlRME56YzVNRGhsT0MwNApaVGt3TFRRd1kyTXRPVGM0WWkxa09XSTJNbVl4TWpFMllXVXdJQmNOTVRnd056SXpNVFV6TkRReldoZ1BNakl4Ck1EQXpNVGt4TmpNME5ETmFNSUhaTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNCTUtRMkZzYVdadmNtNXAKWVRFU01CQUdBMVVFQnhNSlUyRnVJRkpoYlc5dU1Sb3dHQVlEVlFRSkV4RXlOakl6SUVOaGJXbHVieUJTWVcxdgpiakVPTUF3R0ExVUVFUk1GT1RRMU9ETXhLakFvQmdOVkJBb1RJVVZ1ZEdWeWNISnBjMlV0UTI5dWJtVmpkQ0JECmVXSmxjaTFUWldOMWNtbDBlVEVhTUJnR0ExVUVBeE1SUlVNZ1EwRWdVMlZ5ZG1salpYTWdTVWt4TFRBckJnTlYKQkFVVEpEUTNOemt3T0dVNExUaGxPVEF0TkRCall5MDVOemhpTFdRNVlqWXlaakV5TVRaaFpUQ0NBU0l3RFFZSgpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFKZHBDR0pZaldBNzFGU3dzeFJoVEYybTNaZmN2MUJ6ClpkV0JXeEduZkNyRHd6ZnNic1BtSlgxTFQyMnVMeU5zcGJmWmRhNWFUaERuRDk4QlR2SzVOcU8xNFVwd3V0WjUKbmx1dWd3Tjh2RENQTUtrNnZhT2drdWdHWjFnSS94aElwRHF1SWF1YTJLSFRwdVZUa0ZVb0pndmpMZEp0UFR1YQpjZDJsVG00NlhKNGNWT0JGbThUQTNkNVhpU2RwenFhcHhMLy9RMWt4RjQrZklJYXhROUtQc1R1YTNjMGZGSEZtCitxUGF3UDdleGw4bXQ2YnlYbGMxRkdaQ1ZYTFJvQlV1cUMvbG1ZOWZtZGJBLzJjSWQyZVMrd2NUY3EybVB1SjUKbXpWcm5qVnIxZ3dVOVlyU0lObW9MS3diUDFzSGNWV1FkWDNQdis4OGJXZUlyS1ZaeVk1aDNFa0NBd0VBQWFPQwpBVFF3Z2dFd01BNEdBMVVkRHdFQi93UUVBd0lDcERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUlLd1lCCkJRVUhBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekF0QmdOVkhRNEVKZ1FrTldNeFl6SmlNbUV0TVdVeU5TMDAKTlRjMExXRmlNRGt0Tm1RMFpXUmpZVEU1TVdZMU1DOEdBMVVkSXdRb01DYUFKRFZqTVdNeVlqSmhMVEZsTWpVdApORFUzTkMxaFlqQTVMVFprTkdWa1kyRXhPVEZtTlRDQmpRWURWUjBSQklHRk1JR0NnZ2xsWXk1blpTNWpiMjJCCkQyVmpMbkp2WW05MFFHZGxMbU52YlljRWZ3QUFBWWNRQUFBQUFBQUFBQUFBQUFBQUFBQUFBWWNRL29BQUFBQUEKQUFBQUFBQUFBQUFBQVljUS9vQUFBQUFBQUFBQXcwR3d4WnZmaUljRXdLaFhHSWNRL29BQUFBQUFBQUFzVjRQLwovbzhMRTRjUS9vQUFBQUFBQUFEZ2ZDT0xibnEyWWpBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQWlKT1lhYXBWCnh1RlVuY2p1cG5kanpiakJQOGFEWXQ3TnpBSUlhRkVwZ1dFTVdaMmdLMUdqYlFGTmdpYldhWkY3ejhsU05TczEKR1pHd2RYVWNDUjJYVWVEZmdyb29lSVQyby9RcGtMbjBLVUs1TGRGcEJIbjNwMm80bkJEK2F6UnliY1M2TGpSSgpVM1N6bHZOa0J1OGRIZVdhTzNidjhUeFY3MEF2MzJ4UFFaSFBGMktSQjF5T0VodkYrZXlRYkFtdys3WVQwdCsyCkZGVEtLdFVtMkNLeXU0cERXT2pHYVlmeGZzM2UrYW53cGJLSjlhUE4xeThlQ1lqa2JnOXkwS2xQdHc0VFE0THgKRkhOTlRScVd5bktUWFlWWGpDaDNUbkEwWG5YSnh2UTVWSlR6b3l6MGVJRmlrd28zcStJM2JTZGpFcE9hZVJSZgpiZ2dROGFDYzRsSndlZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0="
    steps:
      - uses: actions/checkout@v2
      - name: bootstrap release
        id: bootstrap-release
        #env:
        run: |
          chmod 775 ./script.sh ./before_deploy.sh
          source ./script.sh
          source ./before_deploy.sh
      - name: pr merged
        if: github.event_name == 'push'
        id: pr-merged
        run: |
          chmod 775 deploy.sh && source ./deploy.sh
